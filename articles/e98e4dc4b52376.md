---
title: " ã€Flutterã€‘google maps polyline ã‚’è©¦ã™"
emoji: "ğŸŒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "flutter"
  - "dart"
  - "android"
  - "ios"
  - "googlemap"
published: true
---
# æ¦‚è¦

Google Mapsä¸Šã«Polylineã§ç·šã‚’æç”»ã™ã‚‹éš›ã«ã€Flutterã§ã©ã®ã‚ˆã†ã«å®Ÿè£…ã™ã‚‹ã‹ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

# æ–¹æ³•

ã©ã†ã‚„ã‚‰èª¿ã¹ãŸæ‰€ä»¥ä¸‹ã®2ã¤ã®PubãŒã²ã£ã‹ã‹ã£ãŸã®ã§ã€ãã‚Œãã‚Œã‚’è©¦ã—ã¦æ¯”è¼ƒã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

1. google_maps_flutter ã§ polyline ã‚’æŒ‡å®šã™ã‚‹æ–¹æ³•

https://pub.dev/documentation/google_maps_flutter/latest/google_maps_flutter/GoogleMap/polylines.html

2. flutter_polyline_points ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†æ–¹æ³•

https://pub.dev/packages/flutter_polyline_points

# google_maps_flutter ã§ polyline ã‚’è©¦ã™

æ—©é€Ÿ `google_maps_flutter` ã® `poyline` ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```yaml
dependencies:
  google_maps_flutter: ^2.7.0
```

## ã¾ãšã¯Mapã‚’è¡¨ç¤ºã™ã‚‹ã ã‘ã®ç”»é¢ã‚’ä½œæˆ

`google_maps_flutter_polyline.dart` ã‚’ä»¥ä¸‹å†…å®¹ã§ä½œæˆã—ã¾ã™ã€‚

```dart
import 'dart:async';

import 'package:flutter/material.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';

class GoogleMapsFlutterPolyline extends StatefulWidget {
  const GoogleMapsFlutterPolyline({super.key});

  @override
  State<GoogleMapsFlutterPolyline> createState() =>
      GoogleMapsFlutterPolylineState();
}

class GoogleMapsFlutterPolylineState extends State<GoogleMapsFlutterPolyline> {
  final Completer<GoogleMapController> _controller =
      Completer<GoogleMapController>();

  static const CameraPosition _initialCameraPosition = CameraPosition(
    target: LatLng(35.68123428932672, 139.76714355230686),
    zoom: 14.4746,
  );

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Google Maps Flutter Polyline')),
      body: GoogleMap(
        mapType: MapType.normal,
        initialCameraPosition: _initialCameraPosition,
        onMapCreated: (GoogleMapController controller) {
          _controller.complete(controller);
        },
      ),
    );
  }
}
```

å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªMapãŒè¡¨ç¤ºã•ã‚Œã‚‹ã ã‘ã®ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

![image1.png](/images/e98e4dc4b52376/image1.png =300x)

## å®Ÿéš›ã«Polylineã‚’ä½¿ã£ã¦ã¿ã‚‹

æ¬¡ã«æœ¬é¡Œã®Polylineã‚’ä½¿ã£ã¦ç·šã‚’ã²ã„ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚`google_maps_flutter_polyline.dart`  ã‚’ä»¥ä¸‹ã«ä¿®æ­£ã—ã¾ã™ã€‚

```dart
import 'dart:async';

import 'package:flutter/material.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';

class GoogleMapsFlutterPolyline extends StatefulWidget {
  const GoogleMapsFlutterPolyline({super.key});

  @override
  State<GoogleMapsFlutterPolyline> createState() =>
      GoogleMapsFlutterPolylineState();
}

class GoogleMapsFlutterPolylineState extends State<GoogleMapsFlutterPolyline> {
  final Completer<GoogleMapController> _controller =
      Completer<GoogleMapController>();

  static const CameraPosition _initialCameraPosition = CameraPosition(
    target: LatLng(35.68123428932672, 139.76714355230686),
    zoom: 14.4746,
  );
  final Set<Polyline> _polylines = {};

  @override
  void initState() {
    super.initState();
    _setPolylines();
  }

  void _setPolylines() {
    setState(() {
      _polylines.add(
        const Polyline(
          polylineId: PolylineId('polyline_1'),
          points: [
            LatLng(35.681236, 139.767125),
            LatLng(35.680959, 139.767552),
            LatLng(35.680583, 139.767998),
          ],
          color: Colors.red,
          width: 5,
        ),
      );
      _polylines.add(
        const Polyline(
          polylineId: PolylineId('polyline_2'),
          points: [
            LatLng(35.681236, 139.767125),
            LatLng(35.682839, 139.769435),
            LatLng(35.683342, 139.770674),
          ],
          color: Colors.green,
          width: 5,
        ),
      );
      _polylines.add(
        const Polyline(
          polylineId: PolylineId('polyline_3'),
          points: [
            LatLng(35.681236, 139.767125),
            LatLng(35.680178, 139.766273),
            LatLng(35.679694, 139.765451),
          ],
          color: Colors.blue,
          width: 5,
        ),
      );
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Google Maps Flutter Polyline')),
      body: GoogleMap(
        mapType: MapType.normal,
        initialCameraPosition: _initialCameraPosition,
        polylines: _polylines,
        onMapCreated: (GoogleMapController controller) {
          _controller.complete(controller);
        },
      ),
    );
  }
}
```

ã“ã¡ã‚‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®æ§˜ã«3ã¤ã®ç•°ãªã‚‹è‰²ã®ãƒ©ã‚¤ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

![image2.png](/images/e98e4dc4b52376/image2.png =300x)

### Polylineã‚¯ãƒ©ã‚¹

https://pub.dev/documentation/google_maps_flutter/latest/google_maps_flutter/Polyline-class.html

ã‚µãƒ³ãƒ—ãƒ«ã®å®Ÿè£…ã‚’è¦‹ã¦ã„ãŸã ã‘ã‚‹ã¨åˆ†ã‹ã‚‹ã‚ˆã†ã«ã€ `Polyline` ã® Set ã‚’ `GoogleMap` ã‚¯ãƒ©ã‚¹ã® `polylines` ã«è¨­å®šã™ã‚‹äº‹ã§ç·šã‚’æç”»ã—ã¦ãã‚Œã¾ã™ã€‚

è¨­å®šã™ã‚‹ä¸»ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

- polylineId
  - [PolylineId](https://pub.dev/documentation/google_maps_flutter/latest/google_maps_flutter/PolylineId-class.html) ã‚’æŒ‡å®šã—ã¾ã™
  - PolylineIdã¯ `ã“ã‚Œã¯ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ä¸€æ„ã§ã‚ã‚‹å¿…è¦ã¯ãªãã€ãƒªã‚¹ãƒˆå†…ã§ä¸€æ„ã§ã‚ã‚‹ã ã‘ã§ååˆ†ã§ã™` ã¨ã‚ã‚‹ã‚ˆã†ã«ã€`Polyline` ã® Set å†…ã§ãƒ¦ãƒ‹ãƒ¼ã‚¯ã«ãªã‚Œã°è‰¯ã„ã¿ãŸã„ã§ã™
- points
  - æç”»ã™ã‚‹ãƒãƒªãƒ©ã‚¤ãƒ³ã®é ‚ç‚¹ã§ `List<LatLng>` ã‚’æŒ‡å®šã—ã¾ã™
- color
  - ç·šåˆ†ã®è‰²ã‚’ ARGB ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æŒ‡å®š
- width
  - æç”»ã™ã‚‹ç·šåˆ†ã®å¹…

### ç‚¹ç·šã«ã™ã‚‹

`pattens` ã« PatternItem ã® **[dash](https://pub.dev/documentation/google_maps_flutter/latest/google_maps_flutter/PatternItem/dash.html)** ã‚’è¨­å®šã—ã¦ã‚„ã‚‹ã¨ç‚¹ç·šã«ã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚

```dart
Polyline(
  // ...
  patterns: [PatternItem.dash(20), PatternItem.gap(20)], // â†è¿½åŠ 
),
```

ä¸Šè¨˜ã®æ„å‘³ã¨ã—ã¦20pxã§èµ¤ç·šã‚’å¼•ã„ã¦ã€20pxã®ç©ºç™½ã‚’ä½œã‚‹ã®ã‚’ç¹°ã‚Šè¿”ã—ç‚¹ç·šã«ã—ã¦ã¾ã™ã€‚

![image3.png](/images/e98e4dc4b52376/image3.png =300x)

# flutter_polyline_points ã§ polyline ã‚’è©¦ã™

æ¬¡ã¯ `flutter_polyline_points` ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```yaml
dependencies:
  flutter_polyline_points: ^2.0.1
```

## å®Ÿéš›ã«ä½¿ã£ã¦ã¿ã‚‹

`flutter_polyline_points.dart` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ä»¥ä¸‹å†…å®¹ã§ä½œæˆã—ã¾ã™ã€‚

```dart
import 'dart:async';

import 'package:flutter/material.dart';
import 'package:flutter_polyline_points/flutter_polyline_points.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';

class FlutterPolylinePoints extends StatefulWidget {
  const FlutterPolylinePoints({super.key});

  @override
  State<FlutterPolylinePoints> createState() => FlutterPolylinePointsState();
}

class FlutterPolylinePointsState extends State<FlutterPolylinePoints> {
  final Completer<GoogleMapController> _controller =
      Completer<GoogleMapController>();

  static const CameraPosition _initialCameraPosition = CameraPosition(
    target: LatLng(35.68123428932672, 139.76714355230686),
    zoom: 14.4746,
  );
  final Set<Polyline> _polylines = {};
  final PolylinePoints polylinePoints = PolylinePoints();

  @override
  void initState() {
    super.initState();
    _setPolylines();
  }

  void _setPolylines() async {
    PolylineResult result = await polylinePoints.getRouteBetweenCoordinates(
      request: PolylineRequest(
        origin: const PointLatLng(26.48424, 50.04551),
        destination: const PointLatLng(26.46423, 50.06358),
        mode: TravelMode.walking,
        wayPoints: [PolylineWayPoint(location: "Sabo, Yaba Lagos Nigeria")],
      ),
      googleApiKey: 'YOUR_API_KEY',
    );
    if (result.points.isNotEmpty) {
      setState(() {
        _polylines.add(
          Polyline(
            polylineId: const PolylineId('polyline_1'),
            points: result.points
                .map((p) => LatLng(p.latitude, p.longitude))
                .toList(),
            color: Colors.red,
            width: 5,
          ),
        );
      });
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('FlutterPolylinePoints')),
      body: GoogleMap(
        mapType: MapType.normal,
        initialCameraPosition: _initialCameraPosition,
        onMapCreated: (GoogleMapController controller) {
          _controller.complete(controller);
        },
        polylines: _polylines,
      ),
    );
  }
}
```

`googleApiKey` ã«ã¯äº‹å‰ã«å–å¾—ã—ãŸAPI Keyã‚’è¨­å®šã—ã¾ã™ã€‚â†‘ã‚’å®Ÿè¡Œã™ã‚‹ã¨â†“ã®æ§˜ã«ãªã‚Šã¾ã™ã€‚

![image4.gif](/images/e98e4dc4b52376/image4.gif =300x)

ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒGoogle Maps Platformã® **[Routes API](https://developers.google.com/maps/documentation/routes?hl=ja)** ã‚’ä½¿ã£ã¦ã„ã‚‹ã‚ˆã†ã§ã€

äº‹å‰ã«from-toã®ä½ç½®ã‚’æŒ‡å®šã—ã€ãã®é–“ã®ãƒ«ãƒ¼ãƒˆã‚’è¨ˆç®—ã—ã¦å„pointã‚’é…åˆ—ã§è¿”ã—ã¦ãã‚Œã‚‹æ§˜ã§ã™ã€‚

`flutter_polyline_points` è‡ªä½“ãŒPolylineã‚’ã²ã„ã¦ãã‚Œã‚‹ã¨ã„ã†è¨³ã§ã¯ãªãã€`google_maps_flutter` ã§Polylineã‚’å¼•ããŸã‚ã®pointsã‚’è¨ˆç®—ã—ã¦ãã‚Œã‚‹ã¨ã„ã†æ§˜ãªä½ç½®ä»˜ã‘ã®Pubã®æ§˜ã§ã—ãŸã€‚

# ã¾ã¨ã‚

åŸºæœ¬ã¯ `google_maps_flutter` ã‚’ä½¿ã£ã¦ã€ç‰¹å®šã®åœ°ç‚¹é–“ã®ãƒ«ãƒ¼ãƒˆã‚’æ±‚ã‚ãŸã„ãªã©ã®è¦æ±‚ãŒå‡ºãŸå ´åˆã« `flutter_polyline_points` ã‚’ä½¿ãˆã°è‰¯ã•ãã†ã‹ãªã¨ã„ã†æ„Ÿæƒ³ã§ã—ãŸã€‚

# å‚è€ƒURL

https://zenn.dev/10_tofu_01/articles/271b5b338734e7
