---
title: "ã€Flutterã€‘settings_uiã‚’è©¦ã™"
emoji: "ğŸ”§"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "flutter"
  - "dart"
  - "setting"
  - "pub"
published: false
---

# æ¦‚è¦

[settings_ui ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://pub.dev/packages/settings_ui)ã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã®è¨­å®šç”»é¢ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’è‰²ã€…è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## å‹•ä½œç’°å¢ƒ

```text
- macOS Monterey ãƒãƒ¼ã‚¸ãƒ§ãƒ³12.6 Apple M1
- Flutter SDK ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 3.3.8
- iOS ã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ iPhone 14 Pro iOS 16.0
- Android ã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ Pixel 4 API 32
```

# ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```yaml:pubspec.yaml
dependencies:
  settings_ui: ^2.0.2
```

# æœ€å°é™ã®æ§‹æˆã§å®Ÿè£…ã—ã¦ã¿ã‚‹

```dart
import 'package:flutter/material.dart';
import 'package:hooks_riverpod/hooks_riverpod.dart';
import 'package:settings_ui/settings_ui.dart';

class SettingsPage extends HookConsumerWidget {
  const SettingsPage({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return SettingsList(
      sections: [
        SettingsSection(
          title: const Text('ã‚»ã‚¯ã‚·ãƒ§ãƒ³'),
          tiles: <SettingsTile>[
            SettingsTile.navigation(
              leading: const Icon(Icons.language),
              title: const Text('Language'),
              value: const Text('æ—¥æœ¬èª'),
            ),
          ],
        ),
      ],
    );
  }
}
```

â†‘ã®å®Ÿè£…ã‚’Android/iOSãã‚Œãã‚Œã§å®Ÿè¡Œã™ã‚‹ã¨çµæœã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

|Android|iOS|
|-----|-----|
|![image1](/images/9a20a349d66e5f/image1.png =300x)|![image2](/images/9a20a349d66e5f/image2.png =300x)|

åŸºæœ¬çš„ãªæ§‹æˆã¨ã—ã¦ã¯

- SettingsList
  - `sections` ã«è¤‡æ•°ã® `AbstractSettingsSection` ã‚’æŒã¤
- SettingsSection
  - `tiles` ã«è¤‡æ•°ã® `AbstractSettingsTile` ã‚’æŒã¤
  - ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ç”¨ã« `CustomSettingsSection` ãŒå­˜åœ¨ã™ã‚‹
- SettingsTile
  - ã‚«ã‚¹ã‚¿ãƒ å®Ÿè£…ç”¨ã« `CustomSettingsTile` ãŒå­˜åœ¨ã™ã‚‹

â†‘ã®3ã¤ã‚’ä½¿ç”¨ã—ã¦è¨­å®šç”»é¢ã‚’æ§‹ç¯‰ã—ã¦ã„ãã¾ã™ã€‚

# å„Widget

## SettingsList

`sections` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã« `AbstractSettingsSection` ä¸€è¦§ã‚’è¨­å®šã—ã¾ã™ã€‚ã¾ãŸä»–æŒ‡å®šã§ãã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§æ°—ã«ãªã£ãŸã‚‚ã®ã‚’ä»¥ä¸‹ã«ç‰¹ç­†ã—ã¦ã¾ã™ã€‚

### DevicePlatform platform ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨OSæ¯ã®è¦‹ãŸç›®ã«ã—ã¦ãã‚Œã‚‹ã¿ãŸã„ã§ã™ãŒã€ã“ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¦ãŠãã¨å¥½ããªOSã®è¦‹ãŸç›®ã«å›ºå®šã§ãã¾ã™ã€‚

å…ˆã»ã©â†‘ã®å®Ÿè£…ã‚’ `platform = iOS` ã«å›ºå®šã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```dart
class SettingsPage extends HookConsumerWidget {
  const SettingsPage({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return SettingsList(
      platform: DevicePlatform.iOS, // â† è¿½åŠ 
      sections: [
            ...
          ],
        ),
      ],
    );
  }
}
```

â†“ Androidã‚‚iOSã¨åŒã˜è¦‹ãŸç›®ã«ãªã‚Šã¾ã—ãŸã€‚
(ã©ã¡ã‚‰ã‚‚ `platform: DevicePlatform.iOS` ã§å®Ÿè¡Œã—ã¦ã¾ã™)
|Android|iOS|
|-----|-----|
|![image3](/images/9a20a349d66e5f/image3.png =300x)|![image4](/images/9a20a349d66e5f/image4.png =300x)|

å…¨platformã®å€¤ã§è©¦ã—ã¦ã¿ãŸçµæœä»¥ä¸‹ã®æ§˜ã«ãªã‚Šã¾ã—ãŸã€‚â€» è©¦ã—ãŸç«¯æœ«ã¯iOSã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ã§ã™ã€‚

|platform|ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ|
|-----|-----|
|DevicePlatform.android|![image5](/images/9a20a349d66e5f/image5.png =300x)|
| DevicePlatform.fuchsia |![image6](/images/9a20a349d66e5f/image6.png =300x)|
| DevicePlatform.iOS |![image7](/images/9a20a349d66e5f/image7.png =300x)|
| DevicePlatform.linux |![image8](/images/9a20a349d66e5f/image8.png =300x)|
| DevicePlatform.macOS |![image9](/images/9a20a349d66e5f/image9.png =300x)|
| DevicePlatform.windows |![image10](/images/9a20a349d66e5f/image10.png =300x)|
| DevicePlatform.web |![image11](/images/9a20a349d66e5f/image11.png =300x)|

### ApplicationType applicationType ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

`material` ã¨ `cupertino` ã¨ `both` ã‚’æŒ‡å®šã§ãã¾ã™ã€‚
ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã ã‘ã ã¨ã‚ã‚“ã¾ã‚Šè©³ç´°ãŒåˆ†ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€å®Ÿè£…ã‚’è¦‹ã‚‹é™ã‚Š `brightness` ã®å‚ç…§å…ƒã‚’æ±ºã‚ã‚‹ã®ã«ä½¿ã‚ã‚Œã¦ã„ã‚‹ã¿ãŸã„ã§ã™ã€‚

[å®Ÿè£…éƒ¨åˆ†](https://github.com/yako-dev/flutter-settings-ui/blob/d8d97b23474fc0697334812e9dcfc4d5adb5d071/lib/src/list/settings_list.dart#L124)

```dart
  Brightness calculateBrightness(BuildContext context) {
    final materialBrightness = Theme.of(context).brightness;
    final cupertinoBrightness = CupertinoTheme.of(context).brightness ??
        MediaQuery.of(context).platformBrightness;

    switch (applicationType) {
      case ApplicationType.material:
        return materialBrightness;
      case ApplicationType.cupertino:
        return cupertinoBrightness;
      case ApplicationType.both:
        return platform != DevicePlatform.iOS
            ? materialBrightness
            : cupertinoBrightness;
    }
  }
```

## SettingsSection

`tiles` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã« `AbstractSettingsTile` ä¸€è¦§ã‚’è¨­å®šã—ã¾ã™ã€‚
ä»–æŒ‡å®šã§ãã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦

- title (Widget)
- margin (EdgeInsetsDirectional)

ã‚’æŒ‡å®šã§ãã¾ã™ã€‚

## SettingsTile

å®Ÿéš›ã®è¨­å®šé …ç›®ã‚’å®šç¾©ã—ã¾ã™ã€‚å¿…é ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯ `title` ã®ã¿ã«ãªã£ã¦ã„ã¾ã™ã€‚
ã¾ãŸ SettingsTile ã«ã¯ä»¥ä¸‹ã® Named constructors ãŒç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚

- SettingsTile.navigation
- SettingsTile.switchTile

â†‘ã«é–¢ã—ã¦ã¯å¾Œè¿°ã—ã¦ã„ã¾ã™ã€‚ã¾ãšã¯é€šå¸¸ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ä½œæˆã—ãŸå ´åˆã‚’è¦‹ã¦ã„ãã¾ã™ã€‚

### titleã®ã¿è¨­å®š

ã¾ãšã¯å˜ç´”ã« `title` ã®ã¿è¨­å®šã—ãŸå ´åˆã‚’è©¦ã—ã¦ã¿ã¾ã™ã€‚

```dart
    return SettingsList(
      platform: DevicePlatform.iOS,
      sections: [
        SettingsSection(
          title: const Text('ã‚»ã‚¯ã‚·ãƒ§ãƒ³'),
          tiles: <SettingsTile>[SettingsTile(title: const Text('ã‚¿ã‚¤ãƒˆãƒ«'))],
        ),
      ],
    );
```

â†‘ã®å®Ÿè¡Œçµæœã¯ä»¥ä¸‹ã®æ§˜ã«ãªã‚Šã¾ã™ã€‚
![image12](/images/9a20a349d66e5f/image12.png =300x)

### `leading` ã¨ `trailing` ã‚’è¨­å®š

æ¬¡ã«ã€[ListTile](https://api.flutter.dev/flutter/material/ListTile-class.html) ã¨åŒã˜æ§˜ã« `Widget leading` ã¨ `Widget trailing` ã‚’è¨­å®šã§ãã‚‹ã®ã§ãã¡ã‚‰ã‚‚è©¦ã—ã¦ã¿ã¾ã™ã€‚

```dart
    return SettingsList(
      platform: DevicePlatform.iOS,
      sections: [
        SettingsSection(
          title: const Text('ã‚»ã‚¯ã‚·ãƒ§ãƒ³'),
          tiles: <SettingsTile>[
            SettingsTile(
              leading: const FlutterLogo(), // â† è¿½åŠ 
              title: const Text('ã‚¿ã‚¤ãƒˆãƒ«'),
              trailing: const Icon(Icons.more_vert), // â† è¿½åŠ 
            ),
          ],
        ),
      ],
    );
```

â†‘ã®å®Ÿè¡Œçµæœã¨ã—ã¦ã¯ä»¥ä¸‹ã®æ§˜ã«ãªã‚Šã¾ã™ã€‚
![image13](/images/9a20a349d66e5f/image13.png =300x)

### `description` ã¨ `value`

è£œè¶³æ–‡ã‚’è¡¨ç¤ºã•ã›ã‚‹ `description` ã‚„ã€è¨­å®šå€¤ã‚’è¡¨ç¤ºã•ã›ã‚‹ `value` ã‚’è¨­å®šã§ãã¾ã™ã€‚`Plarform` ã‚„ `SettingsTile.navigation` ã§è¡¨ç¤ºã•ã›ãŸå ´åˆã§æŒ™å‹•ãŒé•ã£ã¦ãã¾ã™ã€‚

ä»¥ä¸‹ã®å®Ÿè£…ã§ `Plarform` ã‚„ `Named constructors` ã‚’ä½¿ç”¨ã—ãŸéš›ã®è¡¨ç¤ºã‚’ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚
ã¾ãŸã€`trailing` ã‚’æŒ‡å®šã™ã‚‹ã¨ `value` ãŒè¡¨ç¤ºã•ã‚Œãªã„ã®ã§å‰Šé™¤ã—ã¦ã¾ã™ã€‚

```dart
SettingsTile(
  leading: const FlutterLogo(),
  title: const Text('ã‚¿ã‚¤ãƒˆãƒ«'),
  description: const Text('description'),
  value: const Text('value'),
)
```

|Platform|ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿|è¡¨ç¤ºçµæœ|
|-----|-----|-----|
|DevicePlatform.iOS|é€šå¸¸|![image14](/images/9a20a349d66e5f/image14.png =300x)|
| DevicePlatform.android | é€šå¸¸ |![image15](/images/9a20a349d66e5f/image15.png =300x)|
| DevicePlatform.web | é€šå¸¸ |![image16](/images/9a20a349d66e5f/image16.png =300x)|
| DevicePlatform.iOS | SettingsTile.navigation |![image17](/images/9a20a349d66e5f/image17.png =300x)|
| DevicePlatform.android | SettingsTile.navigation | ![image18](/images/9a20a349d66e5f/image18.png =300x)|
| DevicePlatform.web | SettingsTile.navigation |![image19](/images/9a20a349d66e5f/image19.png =300x)|

â€» Platformã«é–¢ã—ã¦ã¯ iOS ( macOS / windows ã‚‚åŒã˜), android (fuchsia / linux ã‚‚åŒã˜), web ã§æ¯”è¼ƒã—ã¦ã¾ã™ã€‚

### SettingsTile.switchTile

ON/OFF ã®è¨­å®šé …ç›®ã‚’ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™ã€‚
ä»¥ä¸‹ã®å®Ÿè£…ã§ã€å„ Platform æ¯ã®è¡¨ç¤ºã®é•ã„ã‚’ä»¥ä¸‹ã«ã¾ã¨ã‚ã¦ã¿ã¾ã—ãŸã€‚

```dart
SettingsTile.switchTile(
  leading: const FlutterLogo(),
  title: const Text('ã‚¿ã‚¤ãƒˆãƒ«'),
  description: const Text('description'),
  initialValue: true,
  onToggle: (value) {},
)
```

|Platform|è¡¨ç¤ºçµæœ|
|-----|-----|
|DevicePlatform.iOS|![image20](/images/9a20a349d66e5f/image20.png =300x)|
| DevicePlatform.android |![image21](/images/9a20a349d66e5f/image21.png =300x)|
| DevicePlatform.web |![image22](/images/9a20a349d66e5f/image22.png =300x)|

â€» Platformã«é–¢ã—ã¦ã¯ iOS ( macOS / windows ã‚‚åŒã˜), android (fuchsia / linux ã‚‚åŒã˜), web ã§æ¯”è¼ƒã—ã¦ã¾ã™ã€‚

# ãã®ä»–: package_info_plusã‚’ä½¿ç”¨ã—ã¦ã‚¢ãƒ—ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡¨ç¤º

[package_info_plus](https://pub.dev/packages/package_info_plus)ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ç”¨ã—ã¦ã€è¨­å®šç”»é¢ã«ã‚ˆãã‚ã‚‹ã‚¢ãƒ—ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¡¨ç¤ºã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```yaml
dependencies:
  package_info_plus: ^3.0.2
```

## å®Ÿè£…ä¾‹

```dart
class SettingsPage extends HookConsumerWidget {
  const SettingsPage({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final fromPlatform = useMemoized(PackageInfo.fromPlatform);
    final snapshot = useFuture(fromPlatform);
    if (!snapshot.hasData) {
      return const SizedBox.shrink();
    }

    return SettingsList(
      platform: DevicePlatform.iOS,
      sections: [
        SettingsSection(
          title: const Text('ã‚»ã‚¯ã‚·ãƒ§ãƒ³'),
          tiles: <SettingsTile>[
            SettingsTile(
                leading: const Icon(Icons.info),
                title: const Text('ã‚¢ãƒ—ãƒªã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³'),
                value: Text("${snapshot.data?.version}"))
          ],
        ),
      ],
    );
  }
}
```

å®Ÿè¡Œçµæœã¯â†“ã®æ§˜ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
![image23](/images/9a20a349d66e5f/image23.png =300x)

# ãã®ä»–: ã€ŒãŠå•ã„åˆã‚ã›ã€é …ç›®ã‚’è¿½åŠ ã—ã€ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ãƒ¡ãƒ¼ãƒ©ãƒ¼ãŒç«‹ã¡ä¸ŠãŒã‚‹æ§˜ã«ã™ã‚‹

[url_launcher](https://pub.dev/packages/url_launcher)ã‚’ä½¿ç”¨ã—ã¦é …ç›®ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ãƒ¡ãƒ¼ãƒ©ãƒ¼ãŒèµ·å‹•ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã™ã€‚

## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```yaml
dependencies:
  url_launcher: ^6.1.7
```

## äº‹å‰æº–å‚™

- Android
  - `AndroidManifest.xml` ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¦ãŠã

      ```xml
      <manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.example.xxxx">
      
        <application android:label="@string/app_name" android:name="${applicationName}" android:icon="@mipmap/ic_launcher">
          ...
        </application>
        <!-- ä»¥ä¸‹ã‚’è¿½åŠ  -->
        <queries>
          <intent>
            <action android:name="android.intent.action.VIEW" />
            <data android:scheme="mailto" />
          </intent>
        </queries>
      </manifest>
      ```

- iOS
  - `Info.plist` ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¦ãŠã

      ```xml
      <key>LSApplicationQueriesSchemes</key>
      <array>
        <string>mailto</string>
      </array>
      ```

## å®Ÿè£…ä¾‹

```dart
class SettingsPage extends HookConsumerWidget {
  const SettingsPage({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context, WidgetRef ref) {
    return SettingsList(
      platform: DevicePlatform.iOS,
      sections: [
        SettingsSection(
          title: const Text('ã‚µãƒãƒ¼ãƒˆ'),
          tiles: <SettingsTile>[
            SettingsTile.navigation(
              leading: const Icon(Icons.mail),
              title: const Text('ãŠå•ã„åˆã‚ã›'),
              onPressed: (context) => _launchMailer(),
            ),
          ],
        ),
      ],
    );
  }

  String? _encodeQueryParameters(Map<String, String> params) {
    return params.entries
        .map((MapEntry<String, String> e) =>
            '${Uri.encodeComponent(e.key)}=${Uri.encodeComponent(e.value)}')
        .join('&');
  }

  Future<void> _launchMailer() async {
    const address = 'ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹';
    final Uri uri = Uri(
      scheme: 'mailto',
      path: address,
      query: _encodeQueryParameters(<String, String>{
        'subject': 'ãƒ¡ãƒ¼ãƒ«ã®ä»¶å',
      }),
    );
    if (await canLaunchUrl(uri)) {
      await launchUrl(uri);
    } else {
      // ã‚¨ãƒ©ãƒ¼å‡¦ç†
    }
  }
}
```

å‹•ä½œã‚¤ãƒ¡ãƒ¼ã‚¸ã¨ã—ã¦ã¯ä»¥ä¸‹ã®æ§˜ã«ãªã‚Šã¾ã™ã€‚
![image24](/images/9a20a349d66e5f/image24.gif =300x)


# å‚è€ƒURL

- [Flutterã§è¨­å®šç”»é¢ã‚’å®Ÿè£…ã—ã¦ã¿ãŸ - Qiita](https://qiita.com/yamauchihrt/items/c85b5b29fae758f4383c)