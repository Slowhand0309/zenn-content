---
title: "ã€FlutterÃ—Google Mapsã€‘Cardãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ä½ç½®æƒ…å ±ã‚’Google Mapsã«é€£æºã—ãƒŠãƒ“ã‚’é–‹ã"
emoji: "ğŸš—"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "flutter"
  - "dart"
  - "android"
  - "ios"
  - "googlemap"
published: true
---
# æ¦‚è¦

Flutterã‚¢ãƒ—ãƒªã§åœ°å›³ã‚’è¡¨ç¤ºã—ã€ç‰¹å®šã®åœ°ç‚¹ã«å¿œã˜ãŸCardãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒã‚ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚ä»Šå›ã¯ã€Cardãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãã®åœ°ç‚¹ã‚„ç¾åœ¨åœ°ã‹ã‚‰ã®ãƒ«ãƒ¼ãƒˆæ¡ˆå†…ã‚’Google Mapsã‚¢ãƒ—ãƒªã§ç›´æ¥é–‹ã‘ã‚‹ä»•çµ„ã¿ã‚’å®Ÿè£…ã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

# å‹•ä½œç’°å¢ƒ

- Mac Book Air M3 24GB / macOS: 14.6.1
- iOSã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿: iPhone 15 Pro / iOS: 17.4
- Androidã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿: Android API VanillalceCream arm64-v8a

# ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

fvmã‚’ä½¿ã£ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã—ã¦ã„ãã¾ã™ã€‚

```bash
mkdir google_map_flutter_sample
cd google_map_flutter_sample
fvm use 3.24.3 --force
fvm flutter create .
```

æ¬¡ã«å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¾ã™ã€‚ `pubspec.yaml` ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```yaml
dependencies:
  google_maps_flutter: ^2.9.0
  url_launcher: ^6.3.1
```

Google Maps APIã®ã‚­ãƒ¼ã®å–å¾—ã‚„è¨­å®šã‚’è¡Œã„ã¾ã™ã€‚â†“ã®è¨˜äº‹å‚ç…§

https://zenn.dev/slowhand/articles/f4e4e092f9b72b

æ¬¡ã«å˜ã«Mapã‚’è¡¨ç¤ºã™ã‚‹ã ã‘ã®ç”»é¢ã‚’å®Ÿè£…ã—è¡¨ç¤ºã§ãã‚Œã°OKã§ã™ã€‚

```dart
import 'dart:async';

import 'package:flutter/material.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';

class CardNaviMap extends StatefulWidget {
  const CardNaviMap({super.key});

  @override
  State<CardNaviMap> createState() => _CardNaviMapState();
}

class _CardNaviMapState extends State<CardNaviMap> {
  final Completer<GoogleMapController> _controller =
      Completer<GoogleMapController>();

  static const CameraPosition _initialCameraPosition = CameraPosition(
    target: LatLng(35.68123428932672, 139.76714355230686),
    zoom: 12.0,
  );

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Card Navigation Map')),
      body: GoogleMap(
        mapType: MapType.normal,
        initialCameraPosition: _initialCameraPosition,
        onMapCreated: (GoogleMapController controller) {
          _controller.complete(controller);
        },
      ),
    );
  }
}

```

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º

æ¬¡ã«å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã§ä½¿ã‚ã‚Œã‚‹ã‚ˆã†ãªEntityã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ä»Šå›ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¹ã«ã—ã¾ã—ãŸã€‚

```dart
class Point {
  int id;
  double latitude;
  double longitude;
  String name;

  Point(this.id, this.latitude, this.longitude, this.name);
}
```

ã“ã®ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ãŸã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’å®šç¾©ã—ã¾ã™ã€‚

```dart
final List<Point> samplePoints = [
  Point(1, 35.6586, 139.7454, 'æ±äº¬ã‚¿ãƒ¯ãƒ¼'),
  Point(2, 35.7100, 139.8107, 'æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼'),
  Point(3, 35.6764, 139.6993, 'æ–°å®¿å¾¡è‹‘'),
  Point(4, 35.6605, 139.7297, 'å…­æœ¬æœ¨ãƒ’ãƒ«ã‚º'),
  Point(5, 35.6986, 139.7731, 'ç§‹è‘‰åŸ'),
  Point(6, 35.6553, 139.7630, 'æµœé›¢å®®æ©è³œåº­åœ’'),
  Point(7, 35.6595, 139.7004, 'æ¸‹è°·ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹'),
  Point(8, 35.7170, 139.7745, 'ä¸Šé‡å‹•ç‰©åœ’'),
  Point(9, 35.6718, 139.6946, 'ä»£ã€…æœ¨å…¬åœ’'),
  Point(10, 35.6852, 139.7528, 'çš‡å±…'),
];
```

ã“ã‚Œã‚’Markerã¨ã—ã¦Mapã«è¡¨ç¤ºã•ã›ã¾ã™ã€‚

```dart
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Card Navigation Map')),
      body: GoogleMap(
        mapType: MapType.normal,
        initialCameraPosition: _initialCameraPosition,
        onMapCreated: (GoogleMapController controller) {
          _controller.complete(controller);
        },
        markers: samplePoints // â†è¿½åŠ 
            .map((point) => Marker(
                  markerId: MarkerId(point.id.toString()),
                  position: LatLng(point.latitude, point.longitude),
                ))
            .toSet(),
      ),
    );
  }
```

â†“ã®æ§˜ã«MakerãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°OKã§ã™ã€‚

![image1.png](/images/3618ba935558ab/image1.png =300x)

# Cardãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º

ç¶šã„ã¦ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹Makerã®Cardãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’è¡¨ç¤ºã•ã›ã‚‹ã‚µãƒ³ãƒ—ãƒ«ã‚’ä½œæˆã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```dart
import 'dart:async';

import 'package:flutter/material.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';

class Point {
  int id;
  double latitude;
  double longitude;
  String name;

  Point(this.id, this.latitude, this.longitude, this.name);
}

final List<Point> samplePoints = [
  Point(1, 35.6586, 139.7454, 'æ±äº¬ã‚¿ãƒ¯ãƒ¼'),
  Point(2, 35.7100, 139.8107, 'æ±äº¬ã‚¹ã‚«ã‚¤ãƒ„ãƒªãƒ¼'),
  Point(3, 35.6764, 139.6993, 'æ–°å®¿å¾¡è‹‘'),
  Point(4, 35.6605, 139.7297, 'å…­æœ¬æœ¨ãƒ’ãƒ«ã‚º'),
  Point(5, 35.6986, 139.7731, 'ç§‹è‘‰åŸ'),
  Point(6, 35.6553, 139.7630, 'æµœé›¢å®®æ©è³œåº­åœ’'),
  Point(7, 35.6595, 139.7004, 'æ¸‹è°·ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«äº¤å·®ç‚¹'),
  Point(8, 35.7170, 139.7745, 'ä¸Šé‡å‹•ç‰©åœ’'),
  Point(9, 35.6718, 139.6946, 'ä»£ã€…æœ¨å…¬åœ’'),
  Point(10, 35.6852, 139.7528, 'çš‡å±…'),
];

class CardNaviMap extends StatefulWidget {
  const CardNaviMap({super.key});

  @override
  State<CardNaviMap> createState() => _CardNaviMapState();
}

class _CardNaviMapState extends State<CardNaviMap> {
  final Completer<GoogleMapController> _controller =
      Completer<GoogleMapController>();

  static const CameraPosition _initialCameraPosition = CameraPosition(
    target: LatLng(35.68123428932672, 139.76714355230686),
    zoom: 12.0,
  );

  final _pageController = PageController(
    viewportFraction: 0.85,
  );

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Card Navigation Map')),
      body: Stack(
        alignment: Alignment.bottomCenter,
        children: [
          _map(),
          _cards(),
        ],
      ),
    );
  }

  Widget _map() {
    return GoogleMap(
      mapType: MapType.normal,
      initialCameraPosition: _initialCameraPosition,
      onMapCreated: (GoogleMapController controller) {
        _controller.complete(controller);
      },
      markers: samplePoints
          .map((point) => Marker(
                markerId: MarkerId(point.id.toString()),
                position: LatLng(point.latitude, point.longitude),
                onTap: () async {
                  final index =
                      samplePoints.indexWhere((p) => p.id == point.id);
                  _pageController.jumpToPage(index);
                },
              ))
          .toSet(),
    );
  }

  Widget _cards() {
    return Container(
      height: 148,
      padding: const EdgeInsets.fromLTRB(0, 0, 0, 20),
      child: PageView(
        onPageChanged: (int index) async {
          final selectedPoint = samplePoints.elementAt(index);
          final GoogleMapController controller = await _controller.future;
          final zoomLevel = await controller.getZoomLevel();
          controller.animateCamera(
            CameraUpdate.newCameraPosition(
              CameraPosition(
                target: LatLng(selectedPoint.latitude, selectedPoint.longitude),
                zoom: zoomLevel,
              ),
            ),
          );
        },
        controller: _pageController,
        children: _tiles(),
      ),
    );
  }

  List<Widget> _tiles() {
    return samplePoints.map(
      (point) {
        return Card(
          child: SizedBox(
            height: 100,
            child: Center(
              child: Text(point.name),
            ),
          ),
        );
      },
    ).toList();
  }
}

```

ã“ã¡ã‚‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®æ§˜ãªæŒ™å‹•ã«ãªã‚Šã¾ã™ã€‚

![image2.gif](/images/3618ba935558ab/image2.gif =300x)

# Google Mapã‚¢ãƒ—ãƒªã‚’é–‹ã

ä»Šåº¦ã¯Cardãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ãã®åœ°ç‚¹ã‚’Google Mapã‚¢ãƒ—ãƒªã§é–‹ã‘ã‚‹æ§˜ã«ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

`_launch` ã‚’è¿½åŠ ã— `_tiles` ã‚’ä»¥ä¸‹ã«ä¿®æ­£ã—ã¾ã™ã€‚

```dart
  List<Widget> _tiles() {
    return samplePoints.map(
      (point) {
        return Card(
          child: SizedBox(
            height: 100,
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.center,
              children: [
                Text(point.name),
                const SizedBox(height: 10),
                ElevatedButton(
                  onPressed: () async {
                    final uri = Uri.parse(
                        "https://www.google.com/maps/search/?api=1&query=${point.latitude},${point.longitude}");
                    await _launch(context, uri);
                  },
                  child: const Text('GoogleMapã§è¡¨ç¤º'),
                ),
              ],
            ),
          ),
        );
      },
    ).toList();
  }

  Future<void> _launch(BuildContext context, Uri uri) async {
    if (await canLaunchUrl(uri)) {
      await launchUrl(uri, mode: LaunchMode.externalApplication);
    }
  }
```

- iOSã®ã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ã®å ´åˆ
    ![image3.gif](/images/3618ba935558ab/image3.gif =300x)

- Androidã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ã®å ´åˆ (Google Mapã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)

    ![image4.gif](/images/3618ba935558ab/image4.gif =300x)

â€» Google Maps URLs ã‚’é–‹ãå ´åˆã‚±ãƒ¼ã‚¹æ¯ã«æŒ™å‹•ãŒç•°ãªã‚Šã¾ã™ã€‚è©³ç´°ã¯ã“ã¡ã‚‰ğŸ‘‡

https://zenn.dev/slowhand/articles/5234dc81379f99

# ç¾åœ¨åœ°ã‹ã‚‰å¯¾è±¡ã®åœ°ç‚¹ã¾ã§ã®ãƒŠãƒ“ã‚’Google Mapã‚¢ãƒ—ãƒªã§é–‹ã

ä»Šåº¦ã¯Cardãƒ¡ãƒ‹ãƒ¥ãƒ¼å†…ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ç¾åœ¨åœ°ã‹ã‚‰ãã®åœ°ç‚¹ã¾ã§ã®ãƒŠãƒ“ãŒGoogle Mapã‚¢ãƒ—ãƒªã§é–‹ãã‚ˆã†ã«ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

`_tiles` ã‚’ä»¥ä¸‹ã«ä¿®æ­£ã—ã¾ã™ã€‚

```dart
  List<Widget> _tiles() {
    return samplePoints.map(
      (point) {
        return Card(
          child: SizedBox(
            height: 100,
            child: Column(
              crossAxisAlignment: CrossAxisAlignment.center,
              children: [
                Text(point.name),
                const SizedBox(height: 10),
                Row(
                  mainAxisAlignment: MainAxisAlignment.center,
                  children: [
                    ElevatedButton(
                      onPressed: () async {
                        final uri = Uri.parse(
                            "https://www.google.com/maps/search/?api=1&query=${point.latitude},${point.longitude}");
                        await _launch(context, uri);
                      },
                      child: const Text('GoogleMapã§è¡¨ç¤º'),
                    ),
                    const SizedBox(width: 10),
                    ElevatedButton(
                      onPressed: () async {
                        final uri = Uri.parse(
                            "https://www.google.com/maps/dir/?api=1&destination=${point.latitude},${point.longitude}");
                        await _launch(context, uri);
                      },
                      child: const Text('ãƒŠãƒ“è¡¨ç¤º'),
                    ),
                  ],
                )
              ],
            ),
          ),
        );
      },
    ).toList();
  }
```

â€» ç¾åœ¨åœ°ã¯æ±äº¬é§…ã«è¨­å®šã—ã¦ã„ã¾ã™ã€‚

- iOSã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ã®å ´åˆ
    ![image5.gif](/images/3618ba935558ab/image5.gif =300x)

- Androidã‚·ãƒ¥ãƒŸãƒ¬ãƒ¼ã‚¿ã®å ´åˆ (Google Mapã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
    ![image6.gif](/images/3618ba935558ab/image6.gif =300x)

# å‚è€ƒURL

https://zenn.dev/flutteruniv_dev/articles/bc50ca942eb450