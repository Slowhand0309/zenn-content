---
title: "ã€Reactã€‘react-tableã‚’è©¦ã™"
emoji: "ğŸ“"
type: "tech"
topics:
  - "react"
  - "table"
  - "chakraui"
published: true
published_at: "2022-09-28 22:42"
---

# react-table
[TanStack/table: ğŸ¤– Headless UI for building powerful tables & datagrids for TS/JS - React-Table, Vue-Table, Solid-Table, Svelte-Table](https://github.com/TanStack/table)
Reactã§tableè¡¨ç¤ºã®UIã‚’å®Ÿè£…ã™ã‚‹éš›ã«ä¾¿åˆ©ãªâ†‘ã“ã¡ã‚‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚
ä»–ã«ã‚‚ `solid` ã‚„ `vue`ã€`svelte` ç”¨ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚‚å­˜åœ¨ã—ã¦ã„ã¾ã™ã€‚

## å‹•ä½œç’°å¢ƒ

```
node: v16
react: v18.2.0
react-dom: v18.2.0
@chakra-ui/react: v2.3.1
```

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```sh
$ yarn add @tanstack/react-table
```

## ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãªå®Ÿè£…
ã¾ãšã¯ä¸€ç•ªã‚·ãƒ³ãƒ—ãƒ«ãªå®Ÿè£…ã‚’è©¦ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```tsx
import { ColumnDef, flexRender, getCoreRowModel, useReactTable } from '@tanstack/react-table';
import React from 'react';

type Book = {
  title: string;
  author: string;
};

const books: Book[] = [
  {
    title: 'ãƒãƒªãƒ¼ãƒ»ãƒãƒƒã‚¿ãƒ¼ã¨è³¢è€…ã®çŸ³',
    author: 'J.K.ãƒ­ãƒ¼ãƒªãƒ³ã‚°',
  },
  {
    title: 'ã“ã“ã‚',
    author: 'å¤ç›®æ¼±çŸ³',
  },
];

const columns: ColumnDef<Book, any>[] = [
  {
    accessorKey: 'title',
    header: 'ã‚¿ã‚¤ãƒˆãƒ«',
  },
  {
    accessorKey: 'author',
    header: 'è‘—è€…',
  },
];

export const BasicTable: React.FC = () => {
  const table = useReactTable<Book>({
    data: books,
    columns,
    getCoreRowModel: getCoreRowModel(),
  });
  return (
    <div>
      <table>
        <thead>
          {table.getHeaderGroups().map((headerGroup) => (
            <tr key={headerGroup.id}>
              {headerGroup.headers.map((header) => (
                <th key={header.id}>
                  {header.isPlaceholder ? null : flexRender(header.column.columnDef.header, header.getContext())}
                </th>
              ))}
            </tr>
          ))}
        </thead>
        <tbody>
          {table.getRowModel().rows.map((row) => (
            <tr key={row.id}>
              {row.getVisibleCells().map((cell) => (
                <td key={cell.id}>{flexRender(cell.column.columnDef.cell, cell.getContext())}</td>
              ))}
            </tr>
          ))}
        </tbody>
      </table>
    </div>
  );
};
```
â†‘ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚ã‚·ãƒ³ãƒ—ãƒ«ã™ãã§å‘³æ°—ãªã„ã®ã§æ¬¡ã¯è£…é£¾ã‚’è¿½åŠ ã—ã¦ã¿ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/c89f58ce261d-20220928.png)


## è£…é£¾ã‚’è¿½åŠ 
ä»Šå›ã¯ chakra-ui ã®[Table](https://chakra-ui.com/docs/components/table/usage)ã‚’ä½¿ã£ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚
`BasicTable` ã® return ã‚’ä»¥ä¸‹ã«ä¿®æ­£ã—ã¾ã™ã€‚

```tsx
import { Table, TableContainer, Tbody, Td, Th, Thead, Tr } from '@chakra-ui/react';
...
export const BasicTable: React.FC = () => {
  const table = useReactTable<Book>({
    data: books,
    columns,
    getCoreRowModel: getCoreRowModel(),
  });
  return (
    <TableContainer>
      <Table>
        <Thead>
          {table.getHeaderGroups().map((headerGroup) => (
            <Tr key={headerGroup.id}>
              {headerGroup.headers.map((header) => (
                <Th key={header.id}>
                  {header.isPlaceholder ? null : flexRender(header.column.columnDef.header, header.getContext())}
                </Th>
              ))}
            </Tr>
          ))}
        </Thead>
        <Tbody>
          {table.getRowModel().rows.map((row) => (
            <Tr key={row.id}>
              {row.getVisibleCells().map((cell) => (
                <Td key={cell.id} borderX="1px solid #e2e8f0">
                  {flexRender(cell.column.columnDef.cell, cell.getContext())}
                </Td>
              ))}
            </Tr>
          ))}
        </Tbody>
      </Table>
    </TableContainer>
  );
};
```
â†‘ã‚’å®Ÿè¡Œã™ã‚‹ã¨ä»¥ä¸‹ã¿ãŸããƒ†ãƒ¼ãƒ–ãƒ«ã£ã½ããªã‚Šã¾ã—ãŸ âœ¨
![](https://storage.googleapis.com/zenn-user-upload/089a646b34d8-20220928.png)

## ç·¨é›†ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹
ä»Šåº¦ã¯**ã‚¿ã‚¤ãƒˆãƒ«**éƒ¨åˆ†ã®ã¿ç·¨é›†ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

react-tableã§ã¯metaãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ãˆã‚‹æ§˜ã«ãªã£ã¦ãŠã‚Šã€è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒ å¯èƒ½ãªã®ã§ã€
ç·¨é›†ã•ã‚ŒãŸéš›ã«å‘¼ã°ã‚Œã‚‹Callbackã‚’metaãƒ‡ãƒ¼ã‚¿(`TableMeta`)å†…ã«å®šç¾©ã—ã¦ãã¡ã‚‰ã‚’å‘¼ã¶ã‚ˆã†ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚ã¾ãšã¯ `TableMeta` ã‚’æ‹¡å¼µã™ã‚‹å®Ÿè£…ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```ts
import { RowData } from '@tanstack/table-core';

declare module '@tanstack/table-core' {
  interface TableMeta<TData extends RowData> {
    updateData: (rowIndex: number, columnId: string, value: unknown) => void;
  }
}
```

æ¬¡ã«ç·¨é›†éƒ¨åˆ†ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä»¥ä¸‹å†…å®¹ã§ä½œæˆã—ã¾ã™ã€‚
```tsx
const defaultColumn: Partial<ColumnDef<Book>> = {
  cell: ({ getValue, row: { index }, column: { id }, table }) => {
    const initialValue = getValue();
    if (id !== 'title') {
      return <>{initialValue}</>;
    }
    // eslint-disable-next-line react-hooks/rules-of-hooks
    const [value, setValue] = useState(initialValue);

    const onBlur = () => {
      table.options.meta?.updateData(index, id, value);
    };

    // eslint-disable-next-line react-hooks/rules-of-hooks
    useEffect(() => {
      setValue(initialValue);
    }, [initialValue]);

    return <Input value={value as string} onChange={(e) => setValue(e.target.value)} onBlur={onBlur} />;
  },
};
```
æœ€å¾Œã« `useReactTable` éƒ¨åˆ†ã‚’ä»¥ä¸‹ã«ä¿®æ­£ã—ã¾ã™ã€‚
```tsx
  const table = useReactTable<Book>({
    data: books,
    columns,
    defaultColumn,
    getCoreRowModel: getCoreRowModel(),
    meta: {
      updateData: (index: number, columnId: string, value: any) => {
        console.log(`table update data index:`, index, 'columnId:', columnId, 'value:', value);
      },
    },
  });
```
metaãƒ‡ãƒ¼ã‚¿å†…ã®updateDataã§ç·¨é›†ã•ã‚ŒãŸæ™‚ã®CallbackãŒå—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚
ã“ã“ã¾ã§ã§å‹•ä½œã•ã›ã¦ã¿ã‚‹ã¨ä»¥ä¸‹ã®æ§˜ã«ã€ç·¨é›†ã§ãã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

![](https://storage.googleapis.com/zenn-user-upload/73eec973a6ef-20220928.gif)


# å‚è€ƒURL
- [TanStack Tableã®React Tableã§ãƒªãƒƒãƒãªãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å®Ÿè£…ã—ã¦ã¿ã‚‹ â€“ helog](https://helog.jp/react/tanstack-table/)
- [Top 5 React Table Libraries. Recommended table libraries for react | by Shanika Wickramasinghe | Bits and Pieces](https://blog.bitsrc.io/top-5-react-table-libraries-170505f75da7)
- [Better Tables with React-Table](https://blog.openreplay.com/better-tables-with-react-table)
- [React Table Editable Data Example | TanStack Table Docs](https://tanstack.com/table/v8/docs/examples/react/editable-data)