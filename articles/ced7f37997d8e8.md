---
title: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¯ã«flutter configã‚’è¨­å®šã™ã‚‹"
emoji: "ğŸ¯"
type: "tech"
topics:
  - "flutter"
  - "fvm"
  - "dart"
  - "config"
published: true
published_at: "2021-08-12 11:07"
---

## å‰æ
- **2.0.0** ã‚ˆã‚Šå‰ã®version
    - `flutter config` ã‚’å®Ÿæ–½ã™ã‚‹ã¨ `~/.flutter_settings` ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚‹
- **2.0.0** ä»¥é™ã®version
    - `flutter config` ã‚’å®Ÿæ–½ã™ã‚‹ã¨ `~/.config/flutter/settings` ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚‹

:warning:  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¯ã«flutter confignã‚’è¨­å®šã™ã‚‹å ´åˆã€**2.0.0** ä»¥é™ã®version ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
## æ¦‚è¦
ã‚ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã ã‘ã—ã‹ä½¿ã‚ãªã„è¨­å®šã§ã‚‚ã€`flutter config`  ã™ã‚‹ã¨å…¨èˆ¬ã«åŠ¹ã„ã¦ãã‚‹ã®ã§ã€
ç‰¹å®šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã ã‘ã® `flutter config` ã«ã—ãŸã„ã€‚

â€» ã‚‚ã—ã‹ã—ãŸã‚‰éœ€è¦ç„¡ã„ã‹ã‚‚ã§ã™ãŒã€æ°—ã«ãªã£ã¦èª¿ã¹ãŸéš›ã®ãƒ¡ãƒ¢ã«ãªã‚Šã¾ã™ã€‚ãªã‚“ã‹ã®å‚è€ƒã«ãªã‚Œã°ã€‚ã€‚

## æ–¹æ³•
æ–¹æ³•ã¨ã—ã¦ã¯ **2.0.0** ä»¥é™ã®version ã§è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œã‚‰ã‚Œã‚‹å ´æ‰€ã‚’è¦‹ãŸã‚‰æƒ³åƒä»˜ãã‹ã¨æ€ã„ã¾ã™ãŒã€
[XDG Base Directoryä»•æ§˜](https://specifications.freedesktop.org/basedir-spec/basedir-spec-latest.html)ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€ç’°å¢ƒå¤‰æ•° **XDG_CONFIG_HOME** ã‚’è¨­å®šã—ã¦ãŠã‘ã°ã€
`$XDG_CONFIG_HOME/settings` ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

## é‹ç”¨ä¾‹
ä¾‹ãˆã° [fvm](https://github.com/leoafarias/fvm)ã‚’ä½¿ã£ã¦ã„ã¦ã€è¤‡æ•°ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãã‚Œãã‚Œåˆ¥ã®flutter versionã§é–‹ç™ºã—ã¦ã„ãŸå ´åˆã«ã€
ç‰¹å®šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã ã‘ `--build-dir` ã‚’è¨­å®šã—ã¦ã„ã‚‹ãŒã€ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒã„ã„å ´åˆã€
[direnv](https://github.com/direnv/direnv)ã‚’ä½¿ã£ã¦ã€ç‰¹å®šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç›´ä¸‹ã«ã€`.envrc` ã‚’ä»¥ä¸‹ã®å†…å®¹ã§ä½œæˆã—ã¦ãŠã‘ã°ã€
`fvm flutter config xxxx` ã§è¨­å®šã—ãŸå†…å®¹ãŒã€`.fvm/settings` ã«è¨­å®šã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

```
export XDG_CONFIG_HOME=$PWD/.fvm
```

ã“ã®çŠ¶æ…‹ã§ `fvm flutter config --enable-web` ã¨è¨­å®šã™ã‚‹ã¨ `.fvm/settings` ã«

```json
{
  "enable-web": true
}
```
ãŒä¿å­˜ã•ã‚Œã¾ã™ã€‚

`fvm_config.json` ã¨ä¸€ç·’ã«gitç®¡ç†ã—ã¨ã‘ã°ãƒ¡ãƒ³ãƒãƒ¼é–“ã§å…±æœ‰ã§ãã¦è‰¯ã•ãã†ã§ã™ :sparkles: 

:warning: æ³¨æ„ç‚¹ã¨ã—ã¦XDG Base Directoryä»•æ§˜ã‚’æ¡ç”¨ã—ã¦ã„ã‚‹åˆ¥ã®ãƒ„ãƒ¼ãƒ«ãªã©ã‚’ä¸€ç·’ã«ä½¿ã†å ´åˆã¯ãã¡ã‚‰ã‚‚è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒ
`.fvm` é…ä¸‹ã«ä½œã‚‰ã‚Œã¡ã‚ƒã„ã¾ã™ã€‚ã€‚

## è£œè¶³

å®Ÿéš›ã«configã‚’æ›¸ãå‡ºã—ã¦ã„ã‚‹ç®‡æ‰€ã‚’èª¿ã¹ã¦ã¿ãŸã‚‰ã€[flutterã®ã‚½ãƒ¼ã‚¹](https://github.com/flutter/flutter/blob/91f8b6be510093f6ac5ff4ec1e578641a4f7f9b3/packages/flutter_tools/lib/src/base/config.dart#L195)ã«ã¯â†“ã®æ§˜ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚

```dart
  static String _configPath(
      Platform platform, FileSystem fileSystem, String name) {
    final String homeDirFile =
        fileSystem.path.join(_userHomePath(platform), '.${kConfigDir}_$name');
    if (platform.isLinux || platform.isMacOS) {
      if (fileSystem.isFileSync(homeDirFile)) {
        return homeDirFile;
      }
      final String configDir = platform.environment[kXdgConfigHome] ??
          fileSystem.path.join(_userHomePath(platform), '.config', kConfigDir);
      return fileSystem.path.join(configDir, name);
    }
    return homeDirFile;
  }
```
`kXdgConfigHome = XDG_CONFIG_HOME` ã§å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚
ã¾ãŸã€æ—¢ã« `~/.flutter_settings` ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ã€ãã¡ã‚‰ã®å†…å®¹ã‚’åæ˜ ã™ã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚
ã“ã®å†…å®¹ãŒåæ˜ ã•ã‚ŒãŸã®ãŒã€ [ã“ã¡ã‚‰ã®PR](https://github.com/flutter/flutter/pull/66645) ãŒãƒãƒ¼ã‚¸ã•ã‚ŒãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§
ãã‚Œä»¥å‰ã¯ä»¥ä¸‹ã®æ§˜ãªå®Ÿè£…ã«ãªã£ã¦ã„ã¾ã™ã€‚

```dart
class Config {
  factory Config(
    String name, {
    @required FileSystem fileSystem,
    @required Logger logger,
    @required Platform platform,
  }) {
    final File file = fileSystem.file(fileSystem.path.join(
      _userHomePath(platform),
      name,
    ));
    return Config._(file, logger);
  }

  // Reads the process environment to find the current user's home directory.
  //
  // If the searched environment variables are not set, '.' is returned instead.
  //
  // Note that this is different from FileSystemUtils.homeDirPath.
  static String _userHomePath(Platform platform) {
    final String envKey = platform.operatingSystem == 'windows'
      ? 'APPDATA'
      : 'HOME';
    return platform.environment[envKey] ?? '.';
  }
}
```
`$HOME/.flutter_settings` ã«æ›¸ãè¾¼ã‚€ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚


