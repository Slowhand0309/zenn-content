---
title: "ã€Flutterã€‘Google Maps URLs ã‚±ãƒ¼ã‚¹æ¯ã®æŒ™å‹•ç¢ºèª"
emoji: "ğŸ—ºï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "flutter"
  - "dart"
  - "android"
  - "ios"
  - "googlemap"
published: true
---
# æ¦‚è¦

ã‚¢ãƒ—ãƒªå†…ã§ç‰¹å®šã®ãƒœã‚¿ãƒ³ãªã©ã‚’ã‚¿ãƒƒãƒ—ã—ãŸã‚‰ã€å¤–éƒ¨ã®Google Maps ã‚¢ãƒ—ãƒªã‚„ã€ã‚¢ãƒ—ãƒªãŒæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ãã‚ˆã†ã«ã™ã‚‹éš›ã«å‘¼ã³å‡ºã™URLã®æŒ™å‹•ã‚’ç´°ã‹ãç¢ºèªã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

# æ¤œè¨¼ã—ãŸç’°å¢ƒ

â€» ã“ã®è¨˜äº‹ã§ã¯ä»¥ä¸‹ã®ç’°å¢ƒã§ã®ã¿ç¢ºèªã—ã¦ã„ã¾ã™ã€‚ãªã®ã§ã‚‚ã—ã‹ã—ãŸã‚‰ä»–ã®ç’°å¢ƒã ã¨å‹•ä½œãŒç•°ãªã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ã€‚

- iOS
  - iOS 17.4 iPhone 15 Pro Simulator
  - iOS 17.5.1 iPhone 13 Pro å®Ÿæ©Ÿ
- Android
  - Android 14.0 arm64-v8a Simulator (Pixel 6 Pro)
  - Android 15.0 arm64-v8a (Pixel 8 Pro)

# ã©ã‚“ãªURLã‚’å‘¼ã³å‡ºã›ã°è‰¯ã„ã‹?

https://developers.google.com/maps/documentation/urls/get-started?hl=ja

â†‘ã‚’å‚è€ƒã«ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªURLã‚’å‘¼ã³å‡ºã›ã°è‰¯ã•ãã†ã§ã™ã€‚è©¦ã—ã«ã¾ãšãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦æŒ™å‹•ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã—ãŸã€‚

[https://www.google.com/maps/search/?api=1&query=35.681333175036556,139.76653638895476](https://www.google.com/maps/search/?api=1&query=35.681333175036556,139.76653638895476)

â†‘ã®æ¤œç´¢ã™ã‚‹URLã®ä»–ã«ãƒŠãƒ“ã‚„ã‚¹ãƒˆãƒªãƒ¼ãƒˆãƒ“ãƒ¥ãƒ¼ ãƒ‘ãƒãƒ©ãƒã‚’è¡¨ç¤ºã™ã‚‹ãªã©ã‚ã‚Šã¾ã™ãŒã€ä»Šå›ã¯æ¤œç´¢ã™ã‚‹URLã§è©¦ã—ã¦ã¿ã¾ã™ã€‚

# ãƒ¢ãƒã‚¤ãƒ«ç«¯æœ«ä¸Šã®ãƒ–ãƒ©ã‚¦ã‚¶ã§URLã‚’é–‹ã„ãŸå ´åˆ

- iOSã®å ´åˆ (Safari)
  - Google Mapã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ (å®Ÿæ©Ÿã§ç¢ºèª)
    - Safariã§Google MapãŒé–‹ã
    - ã€Œã‚¢ãƒ—ãƒªã§é–‹ãã€ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨Google Mapã‚¢ãƒ—ãƒªãŒé–‹ã
  - Google Mapã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
    - Safariã§Google MapãŒé–‹ã
    - ã€Œã‚¢ãƒ—ãƒªã§é–‹ãã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŒã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
      ![image1.gif](/images/5234dc81379f99/image1.gif =250x)
- Androidã®å ´åˆ (Chrome)
  - Google Mapã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ
    - Chromeã§Google MapãŒé–‹ãã€ã‚¢ãƒ—ãƒªã§é–‹ãã‚’é¸æŠã—ãŸå ´åˆGoogle Mapã‚¢ãƒ—ãƒªãŒé–‹ã
      ![image2.gif](/images/5234dc81379f99/image2.gif =250x)
  - Google Mapã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
    - Chromeã§Google MapãŒé–‹ãã€ã‚¢ãƒ—ãƒªã§é–‹ãã‚’é¸æŠã—ãŸå ´åˆGoogle Playã«ã¨ã°ã•ã‚Œã‚‹
      ![image3.gif](/images/5234dc81379f99/image3.gif =250x)

# ã‚¢ãƒ—ãƒªã‹ã‚‰URLã‚’é–‹ã„ãŸå ´åˆ

æ¬¡ã«å®Ÿéš›ã«ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¦ã‚¢ãƒ—ãƒªå†…ã‹ã‚‰URLã‚’é–‹ã„ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

æ¤œè¨¼ç”¨ã®Flutterã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
$ mkdir google_maps_flutter_sample
$ cd google_maps_flutter_sample
$ fvm use 3.22.2 --force
$ fvm flutter create . --org com.xxxx.google_map_flutter_sample -e
```

æ¬¡ã«ã€ä»¥ä¸‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å°å…¥ã—ã¦ã€ãƒœã‚¿ãƒ³æŠ¼ã—ãŸã‚‰ä¸Šè¨˜ã®URLã‚’é–‹ãã‚ˆã†ã«ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

https://pub.dev/packages/url_launcher

- url_launcherãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ 

```bash
flutter pub add url_launcher
```

- åˆã¯ `pubspec.yaml` ã«ä»¥ä¸‹ã‚’è¿½åŠ 

```yaml
dependencies:
  url_launcher: ^6.3.0
```

- æ¬¡ã«ä»¥ä¸‹ã®Flutterã‚¢ãƒ—ãƒªã®ç”»é¢ã‚’ä½œæˆã—æ¤œè¨¼ã—ã¦ã„ãã¾ã™

```dart
import 'package:flutter/material.dart';
import 'package:url_launcher/url_launcher.dart';

class MapUrlButton extends StatelessWidget {
  const MapUrlButton({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Map URL Button')),
      body: const Center(
        child: Text("Tap the floating action button to open a map URL."),
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () async {
          final uri = Uri.parse(
              "https://www.google.com/maps/search/?api=1&query=35.681333175036556,139.76653638895476");
          if (await canLaunchUrl(uri)) {
            await launchUrl(uri);
          }
        },
        child: const Icon(Icons.map),
      ),
    );
  }
}
```

- iOSã®å ´åˆ
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ (å®Ÿæ©Ÿã§ç¢ºèª)
    - ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ã§Google MapãŒé–‹ã
    - ã€Œã‚¢ãƒ—ãƒªã§é–‹ãã€ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨Google Mapã‚¢ãƒ—ãƒªãŒé–‹ã
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
    - ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ã§Google MapãŒé–‹ã
    - ã€Œã‚¢ãƒ—ãƒªã§é–‹ãã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŒã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
      ![image4.gif](/images/5234dc81379f99/image4.gif  =250x)
- Androidã®å ´åˆ
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ
    - Google Mapã‚¢ãƒ—ãƒªãŒé–‹ã
      ![image5.gif](/images/5234dc81379f99/image5.gif  =250x)
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
    - url_launcherã® `canLaunchUrl` ã®ãƒã‚§ãƒƒã‚¯ãŒã‚ã‚‹å ´åˆã€ãƒã‚§ãƒƒã‚¯ã«å¼•ã£ã‹ã‹ã£ã‚‹
      ![image6.gif](/images/5234dc81379f99/image6.gif  =250x)
    - url_launcherã® `canLaunchUrl` ã®ãƒã‚§ãƒƒã‚¯ãŒãªã„å ´åˆã€ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã
      ![image7.gif](/images/5234dc81379f99/image7.gif  =250x)

**ã“ã“ã§æ³¨ç›®ã™ã¹ãç‚¹ãŒiOSã§Google Maps ã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã®ã«ã‚‚é–¢ã‚ã‚‰ãšã€ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã„ã¦ã„ã¾ã™ã€‚**
**ã“ã®å ´åˆ `launchUrl` ã® `mode` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ `LaunchMode.externalApplication` ã«ã™ã‚‹äº‹ã§Google Maps ã‚¢ãƒ—ãƒªãŒé–‹ãã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚**

ã¡ãªã¿ã« `LaunchMode.externalApplication` ã«ã™ã‚‹ã¨ Androidã§Google Maps ã‚¢ãƒ—ãƒªãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆã€ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯ãªãChromeãŒé–‹ãã¾ã™ã€‚

# ã‚¢ãƒ—ãƒªå†…ã«Google Mapã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã®æŒ™å‹•

ã•ã‚‰ã«Flutterã‚¢ãƒ—ãƒªã§ [google_maps_flutter](https://pub.dev/packages/google_maps_flutter) ã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã®æŒ™å‹•ã‚’ç¢ºèªã—ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

- google_maps_flutter ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸è¿½åŠ 

```bash
fvm flutter pub add google_maps_flutter
```

åˆã¯ `pubspec.yaml` ã«ä»¥ä¸‹ã‚’è¿½åŠ 

```yaml
dependencies:
  google_maps_flutter: ^2.7.0
```

- APIã‚­ãƒ¼å–å¾—

[ã“ã¡ã‚‰](https://console.cloud.google.com/google/maps-apis/credentials)ã®ãƒšãƒ¼ã‚¸ã¸ç§»å‹•ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠåˆã¯æ–°è¦ã«GCPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã—ã€é¸æŠã—ã¾ã™ã€‚

æ¬¡ã«ã€Œèªè¨¼æƒ…å ±ã‚’ä½œæˆã€>ã€ŒAPIã‚­ãƒ¼ã€ã‚’é¸æŠã—ã¾ã™ã€‚

![image8.png](/images/5234dc81379f99/image8.png)

æ¬¡ã«ä½œæˆã—ãŸAPIã‚­ãƒ¼ã®åå‰ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ¶é™ã®è¨­å®šã§ã€ã€ŒAndroidã‚¢ãƒ—ãƒªã€ã‚’é¸æŠã—ã¾ã™ã€‚APIã®åˆ¶é™ã¯ä»Šå›ãŠè©¦ã—ç”¨ãªã®ã§ã“ã®ã¾ã¾ã§ã„ãã¾ã™ã€‚

![image9.png](/images/5234dc81379f99/image9.png =400x)

æ¬¡ã«åŒã˜ã‚ˆã†ã«APIã‚­ãƒ¼ã‚’ä½œæˆã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®åˆ¶é™ã®è¨­å®šã§ã€ŒiOSã‚¢ãƒ—ãƒªã€ã‚’é¸æŠã—ã¨ãã¾ã™ã€‚

ã“ã‚Œã§å®Ÿéš›ã«é‹ç”¨ã™ã‚‹æ™‚ã¨åŒã˜æ§‹æˆã§Androidã‚¢ãƒ—ãƒªç”¨ã®APIã‚­ãƒ¼ã¨iOSã‚¢ãƒ—ãƒªç”¨ã®APIã‚­ãƒ¼ãŒä½œæˆã•ã‚Œã¾ã—ãŸã€‚

- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®åæ˜ ã¯â†“ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

https://zenn.dev/slowhand/articles/f4e4e092f9b72b

- æ¤œè¨¼ç”¨ã«ä»¥ä¸‹ã®ç”»é¢ã‚’ä½œæˆã—ã¾ã™

```dart
import 'dart:async';

import 'package:flutter/material.dart';
import 'package:google_maps_flutter/google_maps_flutter.dart';
import 'package:url_launcher/url_launcher.dart';

class MapUrlInside extends StatefulWidget {
  const MapUrlInside({super.key});

  @override
  State<MapUrlInside> createState() => BasicMapState();
}

class BasicMapState extends State<MapUrlInside> {
  final Completer<GoogleMapController> _controller =
      Completer<GoogleMapController>();

  static const CameraPosition _initialCameraPosition = CameraPosition(
    target: LatLng(35.68123428932672, 139.76714355230686),
    zoom: 14.4746,
  );

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Map Url Inside')),
      body: GoogleMap(
        mapType: MapType.normal,
        initialCameraPosition: _initialCameraPosition,
        onMapCreated: (GoogleMapController controller) {
          _controller.complete(controller);
        },
        markers: {
          Marker(
            markerId: const MarkerId("Tokyo Station"),
            position: const LatLng(35.681333175036556, 139.76653638895476),
            infoWindow: const InfoWindow(title: "Tokyo Station"),
            onTap: () async {
              final uri = Uri.parse(
                  "https://www.google.com/maps/search/?api=1&query=35.681333175036556,139.76653638895476");
              if (await canLaunchUrl(uri)) {
                await launchUrl(uri);
              }
            },
          ),
        },
      ),
      floatingActionButton: FloatingActionButton(
        onPressed: () async {
          final uri = Uri.parse(
              "https://www.google.com/maps/search/?api=1&query=35.681333175036556,139.76653638895476");
          if (await canLaunchUrl(uri)) {
            await launchUrl(uri);
          }
        },
        child: const Icon(Icons.map),
      ),
    );
  }
}
```

- iOSã®å ´åˆ
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ (å®Ÿæ©Ÿã§ç¢ºèª)
    - FABã§ã‚‚Markerã§ã‚‚æŒ™å‹•ã¯åŒã˜
    - ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ã§Google MapãŒé–‹ã
    - ã€Œã‚¢ãƒ—ãƒªã§é–‹ãã€ã‚’ã‚¿ãƒƒãƒ—ã™ã‚‹ã¨Google Mapã‚¢ãƒ—ãƒªãŒé–‹ã
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
    - FABã§ã‚‚Markerã§ã‚‚æŒ™å‹•ã¯åŒã˜
    - ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ã§Google MapãŒé–‹ã
    - ã€Œã‚¢ãƒ—ãƒªã§é–‹ãã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ãŒã‚¿ãƒƒãƒ—ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹
      ![image11.gif](/images/5234dc81379f99/image11.gif  =250x)
- Androidã®å ´åˆ
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹å ´åˆ
    - FABã§ã‚‚Markerã§ã‚‚æŒ™å‹•ã¯åŒã˜
    - Google Mapã‚¢ãƒ—ãƒªãŒé–‹ã
      ![image13.gif](/images/5234dc81379f99/image13.gif  =250x)
  - Google MapãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„å ´åˆ
    - Makerã®å ´åˆ
      - `mapToolbarEnabled` ã‚’ `true` ã«ã—ã¦æ¤œè¨¼
      - ã‚¢ãƒ—ãƒªå†…ã®Mapä¸Šã«ToolbarãŒè¡¨ç¤ºã•ã‚Œã‚‹ (â†“)
        ![image14.png](/images/5234dc81379f99/image14.png)
      - Toolbarã‚¿ãƒƒãƒ—ã§ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        ![image15.gif](/images/5234dc81379f99/image15.gif  =250x)
    - FABã®å ´åˆ
      - url_launcherã® `canLaunchUrl` ã®ãƒã‚§ãƒƒã‚¯ãŒã‚ã‚‹å ´åˆã€ãƒã‚§ãƒƒã‚¯ã«å¼•ã£ã‹ã‹ã£ã‚‹
        ![image16.gif](/images/5234dc81379f99/image16.gif  =250x)
      - url_launcherã® `canLaunchUrl` ã®ãƒã‚§ãƒƒã‚¯ãŒãªã„å ´åˆã€ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶ãŒé–‹ã
        ![image17.gif](/images/5234dc81379f99/image17.gif  =250x)

# å‚è€ƒURL

https://naipaka.hatenablog.com/entry/2021/08/05/091411