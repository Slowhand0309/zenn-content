---
title: "Artifact Registryã‚’å˜ä½“ã§è‰²ã€…è©¦ã™"
emoji: "ğŸ“¦"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "googlecloud"
  - "artifactregistry"
  - "terraform"
  - "docker"
published: true
---
# æ¦‚è¦

ä»Šå›ã¯æ™®æ®µä½•æ°—ãªãä½¿ã£ã¦ã„ã‚‹ **Artifact Registry** ã‚’å˜ä½“ã§è‰²ã€…è©¦ã—ã¦ã¿ã‚ˆã†ã¨ã„ã†è©¦ã¿ã§ã™ã€‚gcloud CLIã¨Terraformã‚’ä½¿ã£ã¦è©¦ã—ã¦ã¿ãŸè¨˜äº‹ã«ãªã‚Šã¾ã™ã€‚

https://cloud.google.com/artifact-registry/docs/overview?hl=ja

## ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹å½¢å¼

![image1.png](/images/b9f2314f74a850/image1.png)

Dockerã ã‘ã‹ã¨æ€ã£ã¦ã„ã¾ã—ãŸãŒã€è‰²ã€…ã¨ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‚“ã§ã™ã­â€¦

## ã‚µãƒ¼ãƒ“ã‚¹ã®æœ‰åŠ¹ã¨ç„¡åŠ¹ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹

https://cloud.google.com/artifact-registry/docs/enable-service?hl=ja

- ç¾åœ¨æœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª

    ```bash
    gcloud services list --enabled --project={projectId} | grep artifactregistry.googleapis.com
    ```

- æœ‰åŠ¹åŒ–

    ```bash
    gcloud services enable artifactregistry.googleapis.com --project={projectId}
    ```

- ç„¡åŠ¹åŒ–

    ```bash
    gcloud services disable artifactregistry.googleapis.com --project={projectId}
    ```

# Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä¿å­˜ã™ã‚‹

## ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ

è©¦ã—ã« `Docker` å½¢å¼ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¦ã¿ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã— `create_repository.sh` ã¨ã„ã†ãƒ•ã‚¡ã‚¤ãƒ«åã§ä¿å­˜ã—ã¾ã™ã€‚

```bash
#!/bin/bash

set -e

# ä½¿ç”¨æ–¹æ³•ã®è¡¨ç¤º
usage() {
    echo "Usage: $0 <repository> <repository_format> <location> <description>"
    echo "  repository: ãƒªãƒã‚¸ãƒˆãƒªå"
    echo "  location: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹: asia-northeast1ï¼‰"
    echo "  repository_format: docker | npm | maven | python | apt..."
    echo "  description: ãƒªãƒã‚¸ãƒˆãƒªã®èª¬æ˜"
    echo "  project_id: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID"
    exit 1
}

# å¼•æ•°ã®ãƒã‚§ãƒƒã‚¯
if [ $# -ne 5 ]; then
    usage
fi

# LOCATIONã«é–¢ã—ã¦ã¯ gcloud artifacts locations list ã§ç¢ºèªã§ãã¾ã™
REPOSITORY=$1
REPOSITORY_FORMAT=$2
LOCATION=$3
DESCRIPTION=$4
PROJECT_ID=$5

# --immutable-tags: å¸¸ã«åŒã˜ã‚¤ãƒ¡ãƒ¼ã‚¸ ãƒ€ã‚¤ã‚¸ã‚§ã‚¹ãƒˆã‚’æŒ‡ã™ã‚¿ã‚°ã‚’ä½¿ç”¨ã™ã‚‹(å¿…è¦ã‚ã‚Œã°)
# --async: å‡¦ç†ä¸­ã®ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Œäº†ã‚’å¾…ãŸãªã„
# --disable-vulnerability-scanning: è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ã‚’ç„¡åŠ¹ã«ã™ã‚‹(å¿…è¦ã‚ã‚Œã°æœ‰åŠ¹ã«)
gcloud artifacts repositories create $REPOSITORY \
    --repository-format=$REPOSITORY_FORMAT \
    --location=$LOCATION \
    --description=$DESCRIPTION \
    --async \
    --disable-vulnerability-scanning \
    --project=$PROJECT_ID
```

ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚ˆã†ã«å®Ÿè¡Œã™ã‚‹ã¨ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆå‡ºæ¥ã¾ã™ã€‚

```bash
$ chmod +x create_repository.sh
$ ./create_repository.sh sample-repository docker asia-northeast1 sample projectA
```

æˆåŠŸã™ã‚‹ã¨ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ç”»é¢ã§ğŸ‘‡ã®æ§˜ã«ãƒªãƒã‚¸ãƒˆãƒªãŒä½œæˆã§ãã¦ã„ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

![image2.png](/images/b9f2314f74a850/image2.png)

## Pushã™ã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸

ã‚·ãƒ³ãƒ—ãƒ«ãªä»¥ä¸‹ã®Dockerfileã‚’ä½œæˆã—ã€Pushã—ã¦ã¿ã¾ã™ã€‚

```docker
FROM node:22.7.0-bullseye-slim
CMD ["node", "-e", "console.log('Hello, World from Node.js in Docker!')"]
```

â€» Pushã™ã‚‹å‰ã«äº‹å‰ã«å„ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®Dockerãƒªãƒã‚¸ãƒˆãƒªã®èªè¨¼ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```bash
# ä¾‹) ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ãŒasia-northeast1ã®å ´åˆ
$ gcloud auth configure-docker asia-northeast1-docker.pkg.dev --project=projectA
Adding credentials for: asia-northeast1-docker.pkg.dev
After update, the following will be written to your Docker config file located at [/root/.docker/config.json]:
 {
  "credHelpers": {
    "asia-northeast1-docker.pkg.dev": "gcloud"
  }
}

Do you want to continue (Y/n)?  Y

Docker configuration file updated.
```

ã“ã‚Œã‚’ã‚„ã£ã¦ãŠã‹ãªã„ã¨ğŸ‘‡ã®æ§˜ãªã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã™ã€‚

```bash
denied: Unauthenticated request. Unauthenticated requests do not have permission "artifactregistry.repositories.uploadArtifacts" on resource "projects/xxxxxx/locations/asia-northeast1/repositories/sample-repository" (or it may not exist)
```

æº–å‚™ãŒã§ããŸã®ã§ã€æ—©é€ŸDockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã€ä½œæˆã—ãŸãƒªãƒã‚¸ãƒˆãƒªã«Pushã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ã„ã¦ã¿ã¾ã™ã€‚ä»¥ä¸‹ã®å†…å®¹ã§ `build_and_push_docker.sh` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
#!/bin/bash

set -e

usage() {
    echo "Usage: $0 <repository> <location> <project_id>"
    echo "  repository: ãƒªãƒã‚¸ãƒˆãƒªå"
    echo "  location: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹: asia-northeast1ï¼‰"
    echo "  project_id: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID"
    echo "  app: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å"
    exit 1
}

# å¼•æ•°ã®ãƒã‚§ãƒƒã‚¯
if [ $# -ne 4 ]; then
    usage
fi

REPOSITORY=$1
LOCATION=$2
PROJECT_ID=$3
APP=$4

docker build -t ${LOCATION}-docker.pkg.dev/${PROJECT_ID}/${REPOSITORY}/${APP}:latest .
docker push ${LOCATION}-docker.pkg.dev/${PROJECT_ID}/${REPOSITORY}/${APP}:latest
```

å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
$ chmod +x build_and_push_docker.sh
$ ./build_and_push_docker.sh sample-repository asia-northeast1 projectA my-node-app
```

æˆåŠŸã™ã‚‹ã¨ã€ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§ğŸ‘‡ã®æ§˜ã«Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ãŒPushã§ãã¦ã„ã‚‹ã®ãŒç¢ºèªã§ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

![image3.png](/images/b9f2314f74a850/image3.png)

## ãƒªãƒã‚¸ãƒˆãƒªã®å‰Šé™¤

ãƒªãƒã‚¸ãƒˆãƒªã®å‰Šé™¤ã‚‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¦ã¿ã¾ã™ã€‚ä»¥ä¸‹å†…å®¹ã§ `delete_repository.sh` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
#!/bin/bash

set -e

usage() {
    echo "Usage: $0 <repository> <location> <project_id>"
    echo "  repository: ãƒªãƒã‚¸ãƒˆãƒªå"
    echo "  location: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹: asia-northeast1ï¼‰"
    echo "  project_id: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID"
    exit 1
}

# å¼•æ•°ã®ãƒã‚§ãƒƒã‚¯
if [ $# -ne 3 ]; then
    usage
fi

REPOSITORY=$1
LOCATION=$2
PROJECT_ID=$3

gcloud artifacts repositories delete $REPOSITORY \
    --location=$LOCATION \
    --project=$PROJECT_ID \
    --async

```

ä¸Šè¨˜ã‚’å®Ÿè¡Œã—ã¦ãƒªãƒã‚¸ãƒˆãƒªãŒå‰Šé™¤ã•ã‚Œã¦ã„ã‚Œã°OKã§ã™ã€‚

```bash
$ chmod +x delete_repository.sh
$ ./delete_repository.sh sample-repository asia-northeast1 projectA
```

## Terraformã‚’ä½¿ã£ã¦ãƒªãƒã‚¸ãƒˆãƒªä½œæˆ

ã¾ãšã¯Terraform ãŒä½¿ç”¨ã™ã‚‹èªè¨¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
gcloud auth application-default login --no-launch-browser
```

`~/.config/gcloud/application_default_credentials.json` ãŒä½œæˆã•ã‚Œã¾ã™ã€‚

æ¬¡ã« `xxx-tfstate` ãƒã‚±ãƒƒãƒˆã‚’ä½œæˆã—ã€Terraformã®tfstateã‚’GCSã§ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```bash
$ gsutil mb -l asia-northeast1 gs://xxx-tfstate
$ gsutil versioning set on gs://xxx-tfstate
$ gsutil lifecycle set tfstate_lifecycle.json gs://xxx-tfstate
$ gsutil ls # ãƒã‚±ãƒƒãƒˆä¸€è¦§ç¢ºèª
```

æ—©é€Ÿ Artifact Registryã®ãƒªãƒã‚¸ãƒˆãƒªä½œæˆã‚’å®Ÿè£…ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

ä¸€å¿œ `modules/artifact_registry` ã‚’ãƒ¡ã‚¤ãƒ³ã‹ã‚‰å‘¼ã³å‡ºã™ã‚ˆã†ãªå½¢ã§å®Ÿè£…ã—ã¦ã„ãã¾ã™ã€‚

- modules/artifact_registry/main.tf

```hcl
variable "location" {}
variable "repository_id" {}
variable "description" {}

resource "google_artifact_registry_repository" "docker_format_repository" {
  location      = var.location
  repository_id = var.repository_id
  description   = var.description
  format        = "DOCKER"

  docker_config {
    immutable_tags = false
  }
}
```

- artifact_registry/main.tf

```hcl
provider "google" {
  project = "..."
}

terraform {
  backend "gcs" {
    bucket = "xxx-tfstate"
  }
}

module "artifact_registry" {
  source        = "../../modules/artifact_registry"
  location      = "asia-northeast1"
  repository_id = "sample-repository"
  description   = "description"
}
```

`artifact_registry/main.tf` ãŒã‚ã‚‹å ´æ‰€ã§ä»¥ä¸‹ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿæ–½ã™ã‚‹ã¨ãƒªãƒã‚¸ãƒˆãƒªãŒä½œæˆã§ãã¦ã„ã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

```bash
$ terraform init
$ terraform plan
$ terraform apply
```

# npmã§ç®¡ç†ã™ã‚‹Node.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä¿å­˜ã™ã‚‹

https://cloud.google.com/artifact-registry/docs/nodejs?hl=ja

æ¬¡ã«Node.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ãƒªãƒã‚¸ãƒˆãƒªã®ä½œæˆ

æ—©é€Ÿãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚å…ˆç¨‹ä½œæˆã—ãŸ `create_repository.sh` ã‚’ä½¿ã£ã¦ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚

```bash
$ ./create_repository.sh sample-npm-repository npm asia-northeast1 sample-npm projectA
```

æˆåŠŸã™ã‚Œã°ã€Œå½¢å¼ã€ãŒ `npm` ã®ãƒªãƒã‚¸ãƒˆãƒªãŒä½œæˆã•ã‚Œã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

![image4.png](/images/b9f2314f74a850/image4.png)

## ç®¡ç†ã™ã‚‹Node.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½œæˆ

ä»Šå›ã¯ `@sample-npm` ã‚¹ã‚³ãƒ¼ãƒ—ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚ã‚¹ã‚³ãƒ¼ãƒ—ã«é–¢ã—ã¦ã¯ğŸ‘‡ã‚’å‚ç…§ã—ã¦ä¸‹ã•ã„ã€‚

https://docs.npmjs.com/about-scopes

```bash
$ mkdir sample-npm-package
$ cd sample-npm-package
$ npm init --scope=@sample-npm -y
```

ã“ã®æ™‚ã«ä½œæˆã•ã‚ŒãŸ `package.json` ã¯ä»¥ä¸‹ã«ãªã‚Šã¾ã™ã€‚

```json
{
  "name": "@sample-npm/sample-npm-package",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "description": ""
}
```

ãŸã æ–‡å­—åˆ—ã‚’è¿”ã™ `hello` functionãŒã‚ã‚‹ã ã‘ã® `index.js` ã‚‚ä½œæˆã—ã¨ãã¾ã™ã€‚

```jsx
const hello = () => {
  return "Hello from Artifact Registry!";
};
module.exports = hello;
```

## Node.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¬é–‹å…ˆè¨­å®š

 `@sample-npm` ã‚¹ã‚³ãƒ¼ãƒ—ã®å…¬é–‹å…ˆã‚’å…ˆç¨‹ä½œæˆã—ãŸ `sample-npm-repository` ã«è¨­å®šã—ã¾ã™ã€‚

ãã®ç‚ºã« `sample-npm-package/.npmrc` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä»¥ä¸‹ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‡ºåŠ›çµæœã®å†…å®¹ã§ä½œæˆã—ã¾ã™ã€‚

```bash
#!/bin/bash
# example: ./print_setting_npmrc.sh sample-npm-repository asia-northeast1 @sample-npm projectA

set -e

# ä½¿ç”¨æ–¹æ³•ã®è¡¨ç¤º
usage() {
    echo "Usage: $0 <repository> <location> <scope> <project_id>"
    echo "  repository: ãƒªãƒã‚¸ãƒˆãƒªå"
    echo "  location: ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆä¾‹: asia-northeast1ï¼‰"
    echo "  scope: npm ã‚¹ã‚³ãƒ¼ãƒ— (ä¾‹: @sample-npm)"
    echo "  project_id: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆID"
    exit 1
}

# å¼•æ•°ã®ãƒã‚§ãƒƒã‚¯
if [ $# -ne 4 ]; then
    usage
fi

# LOCATIONã«é–¢ã—ã¦ã¯ gcloud artifacts locations list ã§ç¢ºèªã§ãã¾ã™
REPOSITORY=$1
LOCATION=$2
SCOPE=$3
PROJECT_ID=$4

gcloud artifacts print-settings npm --scope=$SCOPE \
    --repository=$REPOSITORY \
    --location=$LOCATION \
    --project=$PROJECT_ID
```

## Node.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

Artifact Registry ãƒªãƒã‚¸ãƒˆãƒªã®èªè¨¼æƒ…å ±ã‚’åæ˜ ã™ã‚‹ç‚ºã«ã€Â [google-artifactregistry-auth](https://www.npmjs.com/package/google-artifactregistry-auth)Â ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚sample-npm-package ã® `package.json` ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```json
"scripts": {
  "artifactregistry-login": "npx google-artifactregistry-auth"
}
```

è¿½åŠ ã—ãŸã‚‰æ—©é€Ÿå®Ÿè¡Œã—ã¾ã™ã€‚

```bash
$ npm run artifactregistry-login
Retrieving application default credentials...
Retrieving credentials from gcloud...
Success!
```

ã“ã“ã¾ã§å‡ºæ¥ãŸã‚‰ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

```bash
npm publish \
    --scope=@sample-npm \
    --registry=https://asia-northeast1-npm.pkg.dev/projectA/sample-npm-repository/
```

æˆåŠŸã™ã‚‹ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ä¸Šã§ã‚‚ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒç¢ºèªã§ãã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

![image5.png](/images/b9f2314f74a850/image5.png)

## ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸNode.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã†

æœ€å¾Œã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸNode.jsãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’åˆ©ç”¨ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚

```bash
$ mkdir use-sample-npm-package
$ cd use-sample-npm-package
$ npm init -y
```

`use-sample-npm-package` ã¨ã„ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã€å…ˆç¨‹ä½œæˆã—ãŸ `.npmrc` ã‚’ã“ã¡ã‚‰ã«ã‚‚ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

```bash
 cp sample-npm-package/.npmrc use-sample-npm-package/.
```

æº–å‚™ãŒæ•´ã£ãŸã®ã§æ—©é€Ÿã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã™ã€‚

```bash
npm install @sample-npm/sample-npm-package
```

æ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã‹ `use-sample-npm-package/index.js` ã‚’ä»¥ä¸‹ã®å†…å®¹ã§ä½œæˆã—å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```jsx
const hello = require('@sample-npm/sample-npm-package');

console.log(hello());
```

æ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«&å®Ÿè¡Œã•ã‚Œã‚‹ã¨ä»¥ä¸‹ã®æ§˜ã«å‡ºåŠ›ã•ã‚Œã‚‹ã‹ã¨æ€ã„ã¾ã™ã€‚

```bash
$ node index.js
Hello from Artifact Registry!
```

# ãƒãƒƒãƒ‰ãƒã‚¦ãƒã‚¦

ã‚‚ã—VSCodeã®Devcontainerã‚’ä½¿ã£ã¦ã„ã¦ã€Docker in Docker ã§ä½¿ã£ã¦ã„ãŸå ´åˆã«ã€VSCodeã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ã‚ãšã€åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ãƒ“ãƒ«ãƒ‰æ™‚ã«ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹äº‹ãŒã‚ã‚Šã¾ã™ã€‚

```bash
ERROR: failed to solve: hayd/alpine-deno:1.10.2: failed to resolve source metadata for docker.io/hayd/alpine-deno:1.10.2:
error getting credentials - err: exit status 255, out: ``
```

ã™ãã§ãã‚‹è§£æ±ºæ–¹æ³•ã¨ã—ã¦ã¯VSCodeã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ãŸã‚‰ã†ã¾ãã„ãã¾ã™ã€‚è©³ç´°ã¯ğŸ‘‡ã‚’å‚ç…§ã€‚

https://qiita.com/suin/items/5bab337469248e3d3a4e

# FYI æ–™é‡‘

https://cloud.google.com/artifact-registry/pricing?hl=ja

- ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
  - æœˆ0.5GBã¾ã§ç„¡æ–™ã§è¶…ãˆãŸã‚‰GBå˜ä½ã§ `$0.10` ã‹ã‹ã‚‹
- ãƒ‡ãƒ¼ã‚¿è»¢é€
  - åŒä¸€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã¾ãŸã¯åŒä¸€ãƒãƒ«ãƒãƒªãƒ¼ã‚¸ãƒ§ãƒ³ / ãƒªãƒ¼ã‚¸ãƒ§ãƒ³â†”åŒå¤§é™¸ãƒãƒ«ãƒãƒªãƒ¼ã‚¸ãƒ§ãƒ³ ã¯ç„¡æ–™
  - ãã‚Œä»¥å¤–ã¯åˆ¥é€”æ–™é‡‘ãŒã‹ã‹ã‚‹

# å‚è€ƒURL

https://developer.so-tech.co.jp/entry/publish-private-npm-packages-with-artifact-registry